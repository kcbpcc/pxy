#!/bin/bash

# Activate the virtual environment
source ~/env/bin/activate

# Change to the script's directory
cd ~/pxy/sys/exe/run

# List the files in two columns with numbers
echo "Available scripts:"
files=($(ls *pxy.py))
columns=2
rows=$(( (${#files[@]} + columns - 1) / columns ))

# Create an associative array to map script numbers to filenames
declare -A script_numbers
for ((i=0; i<${#files[@]}; i++)); do
    script_number=$((i+1))
    script_name="${files[i]%.pxy.py}"
    script_numbers[$script_number]="${files[i]}"
    printf "%-4s%-20s" "$script_number." "$script_name"
    if (( (i+1) % columns == 0 )) || (( i+1 == ${#files[@]} )); then
        echo
    fi
done

# Prompt the user for the script's number or name
read -p "Enter the number or name of the script to execute ðŸ‘‰: " script_input

# Check if the input is a number
if [[ $script_input =~ ^[0-9]+$ ]]; then
    # Validate the input number
    if (( script_input < 1 || script_input > ${#files[@]} )); then
        echo "Error: Invalid script number. Please enter a valid number."
        exit 1
    fi
    selected_script=${script_numbers[$script_input]}
else
    # If the input is a name, append "pxy.py" to it
    script_input="${script_input}pxy.py"
    # Check if the modified input corresponds to an existing file
    if [[ ! -f "$script_input" ]]; then
        echo "Error: The specified script '$script_input' does not exist."
        exit 1
    fi
    selected_script="$script_input"
fi

# Run the selected script
python3 "$selected_script"

