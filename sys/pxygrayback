#!/bin/bash

# Function to install necessary packages
install_packages() {
    echo "Installing necessary packages..."
    sudo apt update
    sudo apt install -y dconf-cli gnome-terminal
}

# Function to get the list of profile IDs
get_profile_ids() {
    gsettings get org.gnome.Terminal.ProfilesList list | tr -d "[],' " | tr -d '\n' | tr ' ' '\n'
}

# Function to change the background color
change_bg_color() {
    local profile_id="$1"
    local color="$2"
    gsettings set org.gnome.Terminal.Legacy.Profile:/org/gnome/terminal/legacy/profiles:/:${profile_id}/ background-color "'${color}'"
}

# Main script execution starts here

# Check if dconf-cli and gnome-terminal are installed
if ! command -v dconf &> /dev/null || ! command -v gnome-terminal &> /dev/null; then
    install_packages
fi

# Get the profile IDs
profile_ids=$(get_profile_ids)

# Check if any profile IDs were found
if [ -z "$profile_ids" ]; then
    echo "No profiles found. Exiting."
    exit 1
fi

# Define the red color
red_color="rgb(255,0,0)"

# Change the background color for the first profile ID found
for profile_id in $profile_ids; do
    change_bg_color "$profile_id" "$red_color"
    echo "Background color changed to red for profile ID: $profile_id"
    break
done

echo "Script execution completed."

