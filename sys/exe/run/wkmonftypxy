from datetime import datetime, timedelta

def get_this_thursday(period='weekly', adjust=7):
    current_date = datetime.now()
    
    if period == 'weekly':
        days_until_this_thursday = (3 - current_date.weekday() + 7) % 7
        if days_until_this_thursday == 0:
            expiry_year = current_date.strftime("%y")
            expiry_month = current_date.strftime("%b").upper()  # Convert to all caps
            expiry_day = current_date.strftime("%d").zfill(2)
            return expiry_year, expiry_month, expiry_day
        this_thursday = current_date + timedelta(days=days_until_this_thursday)
        expiry_year = this_thursday.strftime("%y")
        expiry_month = this_thursday.strftime("%b").upper()  # Convert to all caps
        expiry_day_adjust = timedelta(days=adjust)  # Adjustment of days
        expiry_day = (this_thursday - expiry_day_adjust).strftime("%d").zfill(2)
        return expiry_year, expiry_month, expiry_day

    elif period == 'monthly':
        last_day_of_month = (current_date.replace(day=28) + timedelta(days=4)).replace(day=1) - timedelta(days=1)
        last_thursday_of_month = last_day_of_month - timedelta(days=(last_day_of_month.weekday() + 1) % 7)
        expiry_year = last_thursday_of_month.strftime("%y")
        expiry_month = last_thursday_of_month.strftime("%b").upper()  # Convert to all caps
        return expiry_year, expiry_month, last_thursday_of_month.strftime("%d").zfill(2)

    else:
        return None
